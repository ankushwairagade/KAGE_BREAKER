/*!
 * froala_editor v2.4.3 (https://www.froala.com/wysiwyg-editor)
 * License https://froala.com/wysiwyg-editor/terms/
 * Copyright 2014-2017 Froala Labs
 */

!function(a){"function"==typeof define&&define.amd?define(["jquery"],a):"object"==typeof module&&module.exports?module.exports=function(b,c){return void 0===c&&(c="undefined"!=typeof window?require("jquery"):require("jquery")(b)),a(c),c}:a(jQuery)}(function(a){a.FE.PLUGINS.wordPaste=function(b){function c(){b.events.on("paste.beforeCleanup",function(a){return a.match(/(class=\"?Mso|class=\'?Mso|style=\"[^\"]*\bmso\-|style=\'[^\']*\bmso\-|w:WordDocument)/gi)&&(a=a.replace(/^\n*/g,"").replace(/^ /g,""),0===a.indexOf("<colgroup>")&&(a="<table>"+a+"</table>"),a=v(a,b.paste.getRtfClipboard()),a=b.paste.removeEmptyTags(a)),a})}function d(a,b){if(b(a))for(var c=a.firstChild;c;){var e=c,f=c.previousSibling;c=c.nextSibling,d(e,b),e.previousSibling||e.nextSibling||e.parentNode||!c||f==c.previousSibling||!c.parentNode?e.previousSibling||e.nextSibling||e.parentNode||!c||c.previousSibling||c.nextSibling||c.parentNode||(f?c=f.nextSibling?f.nextSibling.nextSibling:null:a.firstChild&&(c=a.firstChild.nextSibling)):c=f?f.nextSibling:a.firstChild}}function e(a){return a.nodeType==Node.ELEMENT_NODE&&a.getAttribute("style")&&a.getAttribute("style").replace("\n","").indexOf("mso-list:Ignore")!=-1}function f(a){if(!a.getAttribute("style")||a.getAttribute("style").replace("\n","").indexOf("mso-list:l")==-1)return!1;try{var b=a.firstElementChild.firstElementChild,c=b.firstElementChild?b.firstElementChild:null;if(!e(b)&&!e(c))return!1}catch(d){return!1}return!0}function g(a){return a.getAttribute("style").replace("\n","").replace(/.*level([0-9]+?).*/gi,"$1")}function h(a,b){var c=a.cloneNode(!0);if(c.firstElementChild&&"A"==c.firstElementChild.tagName&&(c=c.firstElementChild),c.firstElementChild.remove(),["H1","H2","H3","H4","H5","H6"].indexOf(a.tagName)!=-1){var e=document.createElement(a.tagName.toLowerCase());e.setAttribute("style",a.getAttribute("style")),e.innerHTML=c.innerHTML,c.innerHTML=e.outerHTML}d(c,function(a){return a.nodeType==Node.ELEMENT_NODE&&t(a,null,b),!0});var f=c.innerHTML;return f=f.replace(/<!--[\s\S]*?-->/gi,"")}function i(a,b){var c=/[0-9a-zA-Z]./gi,d=!1;a.firstElementChild&&a.firstElementChild.firstElementChild&&a.firstElementChild.firstElementChild.firstChild&&(d=d||c.test(a.firstElementChild.firstElementChild.firstChild.data),!d&&a.firstElementChild.firstElementChild.firstElementChild&&a.firstElementChild.firstElementChild.firstElementChild.firstChild&&(d=d||c.test(a.firstElementChild.firstElementChild.firstElementChild.firstChild.data)));var e=d?"ol":"ul",j=g(a),k="<"+e+"><li>"+h(a,b),l=a.nextElementSibling,m=a.parentNode;for(a.remove(),a=null;l&&f(l);){var n=l.previousElementSibling,o=g(l);if(o>j)k+=i(l,b).outerHTML;else{if(o<j)break;k+="</li><li>"+h(l,b)}if(j=o,l.previousElementSibling||l.nextElementSibling||l.parentNode){var p=l;l=l.nextElementSibling,p.remove(),p=null}else l=n?n.nextElementSibling:m.firstElementChild}k+="</li></"+e+">";var q=document.createElement("div");q.innerHTML=k;var r=q.firstElementChild;return r}function j(a,b){for(var c=document.createElement(b),d=0;d<a.attributes.length;d++){var e=a.attributes[d].name;c.setAttribute(e,a.getAttribute(e))}return c.innerHTML=a.innerHTML,a.parentNode.replaceChild(c,a),c}function k(a){var b=null;if(a.firstElementChild&&(b=a.firstElementChild.tagName,["SPAN","STRONG","B","S","EM","U","SUB","SUP"].indexOf(b)!=-1)){if("TD"!=a.tagName)for(var c=a.firstElementChild;c;){if("SPAN"==c.tagName){o(c,a.getAttribute("style"));break}c=c.firstElementChild}}else if("DIV"!=b){var d=a.getAttribute("style"),e=document.createElement("span");d&&(d=n(d),e.setAttribute("style",d)),e.innerHTML=a.innerHTML,a.innerHTML=e.outerHTML}}function l(c,d){b.node.clearAttributes(c);for(var e=c.firstElementChild,f=0,g=!1,h=null;e;){e.firstElementChild&&e.firstElementChild.tagName.indexOf("W:")!=-1&&(e.innerHTML=e.firstElementChild.innerHTML),h=e.getAttribute("width"),h||g||(g=!0),f+=parseInt(h,10),(!e.firstChild||e.firstChild&&e.firstChild.data==a.FE.UNICODE_NBSP)&&(e.firstChild&&e.firstChild.remove(),e.innerHTML="<br>");for(var i=e.firstElementChild,l=1==e.children.length;i;){if("P"==i.tagName){var p=null;1==i.children.length&&i.firstElementChild&&"SPAN"==i.firstElementChild.tagName?(p=i.firstElementChild,l||(p=j(p,"div")),l||o(p,i.getAttribute("style")),e.replaceChild(p,i)):(p=j(i,l?"span":"div"),p.removeAttribute("style")),i=p,l&&m(i)}i=i.nextElementSibling}if(d){var r=e.getAttribute("class");if(r){r=n(r);var s=r.match(/xl[0-9]+/gi);if(s){var t=s[0],u="."+t;d[u]&&o(e,d[u])}}d.td&&o(e,d.td),k(e),q(e)}var v=e.getAttribute("style");v&&(v=n(v),v&&";"!=v.slice(-1)&&(v+=";"));var w=e.getAttribute("valign");if(!w&&v){var x=v.match(/vertical-align:.+?[; "]{1,1}/gi);x&&(w=x[x.length-1].replace(/vertical-align:(.+?)[; "]{1,1}/gi,"$1"))}var y=null;if(v){var z=v.match(/text-align:.+?[; "]{1,1}/gi);z&&(y=z[z.length-1].replace(/text-align:(.+?)[; "]{1,1}/gi,"$1")),"general"==y&&(y=null)}var A=null;if(v){var B=v.match(/background:.+?[; "]{1,1}/gi);B&&(A=B[B.length-1].replace(/background:(.+?)[; "]{1,1}/gi,"$1"))}var C=e.getAttribute("colspan");b.node.clearAttributes(e),C&&e.setAttribute("colspan",C),w&&(e.style["vertical-align"]=w),y&&(e.style["text-align"]=y),A&&(e.style["background-color"]=A),h&&e.setAttribute("width",h),e=e.nextElementSibling}for(e=c.firstElementChild;e;)h=e.getAttribute("width"),g?e.removeAttribute("width"):e.setAttribute("width",100*parseInt(h,10)/f+"%"),e=e.nextElementSibling}function m(a){var b=a.parentNode,c=a.getAttribute("align");c&&(b&&"TD"==b.tagName?(b.setAttribute("style",b.getAttribute("style")+"text-align:"+c+";"),a.removeAttribute("align")):(a.style["text-align"]=c,a.removeAttribute("align")))}function n(a){return a.replace(/\n|\r|\n\r|&quot;/g,"")}function o(a,b,c){var d=a.getAttribute("style");d&&";"!=d.slice(-1)&&(d+=";"),b&&";"!=b.slice(-1)&&(b+=";");var e=null;e=c?(d||"")+b:b+(d||""),a.setAttribute("style",e)}function p(a){var b=a.getAttribute("style");if(b){b=n(b),b&&";"!=b.slice(-1)&&(b+=";");var c=b.match(/(^|\S+?):.+?;{1,1}/gi);if(c){for(var d={},e=0;e<c.length;e++){var f=c[e],g=f.split(":");2==g.length&&("text-align"==g[0]&&"SPAN"==a.tagName||(d[g[0]]=g[1]))}var h="";for(var i in d)if(d.hasOwnProperty(i)){if("font-size"==i&&"pt;"==d[i].slice(-3)){var j=null;try{j=parseFloat(d[i].slice(0,-3),10)}catch(k){}j&&(j=Math.round(1.33*j),d[i]=j+"px;")}h+=i+":"+d[i]}h&&a.setAttribute("style",h)}}}function q(a){var b=a.getAttribute("style");if(b){b=n(b);var c=b.match(/(^|;)font-weight:.+?[; "]{1,1}/gi),d=null;if(c&&(d=c[c.length-1].replace(/(^|;)font-weight:(.+?)[; "]{1,1}/gi,"$2")),d&&(d>=700||"bold"==d)){var e=document.createElement("strong");e.innerHTML=a.innerHTML,a.innerHTML=e.outerHTML}}}function r(a){for(var b=a.match(/[0-9a-f]{2}/gi),c=[],d=0;d<b.length;d++)c.push(String.fromCharCode(parseInt(b[d],16)));var e=c.join("");return btoa(e)}function s(a,b){if(b){var c=a.getAttribute("src");if(c&&c.indexOf("file://")!=-1){var d=a.getAttribute("v:shapes");if(d){if(d.indexOf("Picture")!=-1&&a.previousSibling){var e=a.previousSibling.previousSibling;if(!e)return;var f=e.data.split('o:spid="');if(2!=f.length)return;if(f=f[1].split('"'),f.length<2)return;d=f[0]}var g="hplid"+d.substring(8),h=b.split(g);if(!h||2==h.length){var i=h[1].split("bliptag");if(!(i&&i.length<2)){var j=null;if(i[0].indexOf("pngblip")!=-1?j="image/png":i[0].indexOf("jpegblip")!=-1&&(j="image/jpeg"),j){var k=i[1].split("}");if(!(k&&k.length<2)){var l=k[0].split(" ");if(!(l&&l.length<2)){l.shift();var m=l.join(""),n=r(m),o="data:"+j+";base64,"+n;a.setAttribute("src",o)}}}}}}}}}function t(c,d){var e=c.tagName,f=e.toLowerCase();c.firstElementChild&&("I"==c.firstElementChild.tagName?j(c.firstElementChild,"em"):"B"==c.firstElementChild.tagName&&j(c.firstElementChild,"strong"));var g=["SCRIPT","APPLET","EMBED","NOFRAMES","NOSCRIPT"];if(g.indexOf(e)!=-1)return c.remove(),!1;"O:P"==e&&"&nbsp;"==c.innerHTML&&(c.innerHTML=a.FE.INVISIBLE_SPACE);var h=-1,i=["META","LINK","XML","ST1:","O:","W:","FONT"];for(h=0;h<i.length;h++)if(e.indexOf(i[h])!=-1)return c.innerHTML?(c.outerHTML=c.innerHTML,c.remove(),!1):(c.remove(),!1);if("TD"!=e){var p=c.getAttribute("class");if(d&&p){p=n(p);var r=p.split(" ");for(h=0;h<r.length;h++){var s=r[h],t=[],u="."+s;t.push(u),u=f+u,t.push(u);for(var v=0;v<t.length;v++)d[t[v]]&&o(c,d[t[v]])}}d&&d[f]&&o(c,d[f])}var w=["P","H1","H2","H3","H4","H5","H6","PRE"];if(w.indexOf(e)!=-1){k(c),q(c);var x=c.getAttribute("style"),y=null;if(x){var z=x.match(/text-align:.+?[; "]{1,1}/gi);z&&(y=z[z.length-1].replace(/(text-align:.+?[; "]{1,1})/gi,"$1"))}y?c.setAttribute("style",y):c.removeAttribute("style")}if("P"==e&&m(c),"TR"==e&&l(c,d),c.getAttribute("class")&&c.getAttribute("class").toLowerCase().indexOf("mso")!=-1){var A=n(c.getAttribute("class"));A=A.replace(/[0-9a-z-_]*mso[0-9a-z-_]*/gi,""),A?c.setAttribute("class",A):c.removeAttribute("class")}if("A"==e&&!c.attributes.getNamedItem("href")&&c.innerHTML&&(c.outerHTML=c.innerHTML),"TD"!=e&&"TH"!=e||c.innerHTML||(c.innerHTML="<br>"),"TABLE"==e&&(b.node.clearAttributes(c),c.setAttribute("style","width: 100%;")),c.getAttribute("lang")&&c.removeAttribute("lang"),c.getAttribute("style")&&c.getAttribute("style").toLowerCase().indexOf("mso")!=-1){var B=n(c.getAttribute("style"));B=B.replace(/[0-9a-z-_]*mso[0-9a-z-_]*:.+?(;{1,1}|$)/gi,""),B?c.setAttribute("style",B):c.removeAttribute("style")}return!0}function u(a){var b={},c=a.getElementsByTagName("style");if(c.length)for(var d=c[0],e=d.innerHTML.match(/[\S ]+\s+{[\s\S]+?}/gi),f=0;f<e.length;f++){var g=e[f],h=g.replace(/([\S ]+\s+){[\s\S]+?}/gi,"$1"),i=g.replace(/[\S ]+\s+{([\s\S]+?)}/gi,"$1");h=h.replace(/^[\s]|[\s]$/gm,""),i=i.replace(/^[\s]|[\s]$/gm,""),h=h.replace(/\n|\r|\n\r/g,""),i=i.replace(/\n|\r|\n\r/g,"");for(var j=h.split(", "),k=0;k<j.length;k++)b[j[k]]=i}return b}function v(c,e){var g=new DOMParser,h=g.parseFromString(c,"text/html"),j=h.children[0],k=j.children[0],l=j.children[1],m=u(k);d(l,function(b){return!(b.nodeType==Node.TEXT_NODE&&!/\S/.test(b.data)&&/\n/.test(b.data))||(b.data==a.FE.UNICODE_NBSP||(b.remove(),!1))}),d(l,function(a){return a.nodeType==Node.ELEMENT_NODE&&"IMG"==a.tagName&&s(a,e),!0}),d(l,function(a){if(a.nodeType==Node.TEXT_NODE)return a.data=a.data.replace(/<br>(\n|\r)/gi,"<br>"),!1;if(a.nodeType==Node.ELEMENT_NODE){if(f(a)){var b=a.parentNode,c=a.previousSibling,d=i(a,e),g=null;return g=c?c.nextSibling:b.firstChild,g?b.insertBefore(d,g):b.appendChild(d),!1}return t(a,m,e)}return a.nodeType!=Node.COMMENT_NODE||(a.remove(),!1)}),d(l,function(a){if(a.nodeType==Node.ELEMENT_NODE){var b=a.tagName;if(!a.innerHTML&&["BR","IMG"].indexOf(b)==-1){for(var c=a.parentNode;c&&(a.remove(),a=c,!a.innerHTML);)c=a.parentNode;return!1}p(a)}return!0});var n=l.outerHTML,o=b.opts.htmlAllowedStyleProps;return b.opts.htmlAllowedStyleProps=b.opts.pasteAllowedStyleProperties,n=b.clean.html(n,b.opts.pasteDeniedTags,b.opts.pasteDeniedAttrs,!1),b.opts.htmlAllowedStyleProps=o,n}return{_init:c}}});